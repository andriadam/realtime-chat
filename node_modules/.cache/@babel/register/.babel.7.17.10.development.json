{"{\"assumptions\":{},\"sourceRoot\":\"D:\\\\$ Adam\\\\$Code\\\\NodeJS\\\\realtime-chat\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"D:\\\\$ Adam\\\\$Code\\\\NodeJS\\\\realtime-chat\",\"filename\":\"D:\\\\$ Adam\\\\$Code\\\\NodeJS\\\\realtime-chat\\\\app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"D:\\\\$ Adam\\\\$Code\\\\NodeJS\\\\realtime-chat\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"regenerator-transform\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.10:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _path = _interopRequireDefault(require(\"path\"));\n\nvar _http = _interopRequireDefault(require(\"http\"));\n\nvar _publicIp = _interopRequireDefault(require(\"public-ip\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar LocalStorage = require(\"node-localstorage\").LocalStorage; // import LocalStorage from \"node-localstorage\";\n\n\nvar localStorage = new LocalStorage(\"./scratch\");\n\nvar iplocate = require(\"node-iplocate\"); // import iplocate from \"node-iplocate\";\n\n\nvar app = (0, _express[\"default\"])();\napp.set(\"port\", process.env.PORT || 9900);\napp.use(_express[\"default\"][\"static\"](_path[\"default\"].join(__dirname, \"public\"))); // Set up express\n\nvar server = _http[\"default\"].createServer(app).listen(app.get(\"port\"), function () {\n  console.log(\"Express server listening on port \" + app.get(\"port\"));\n});\n\nvar io = require(\"socket.io\")(server);\n\nvar users = []; // connection event\n// socket represent each client connected to our server\n\nio.on(\"connection\", function (socket) {\n  socket.on(\"connect\", function () {\n    console.log(\"New connection socket.io : \", socket.io);\n  });\n  socket.on(\"disconnect\", function () {\n    console.log(\"disconect => nickname : \", socket.nickname);\n    var updatedUsers = users.filter(function (user) {\n      return user != socket.nickname;\n    });\n    console.log(\"updatedUsers : \", updatedUsers);\n    users = updatedUsers;\n    io.emit(\"userlist\", users);\n  }); //  nick event\n\n  socket.on(\"nick\", function (nickname) {\n    console.log(\"nick => nickname : \", nickname);\n    socket.nickname = nickname;\n    users.push(nickname);\n    console.log(\"server : users\", users); // emit userlist event to all connected sockets\n\n    io.emit(\"userlist\", users);\n  }); //  chat event\n\n  socket.on(\"chat\", function (data) {\n    console.log(\"chat => nickname : \", socket.nickname);\n    var d = new Date();\n    var ts = d.toLocaleString();\n    console.log(\"ts : \", ts);\n    console.log(\"rs : \", response);\n    var response = \"\".concat(ts, \" : \").concat(socket.nickname, \" : \").concat(data.message);\n\n    _publicIp[\"default\"].v4().then(function (ip) {\n      console.log(\"ip\", ip);\n      iplocate(ip).then(function (results) {\n        console.log(\"iplocate\", results);\n        var respo = JSON.stringify(results.city);\n        localStorage.setItem(\"userlocal\", respo);\n        var response = \"\".concat(ts, \" | \").concat(respo, \" : \").concat(socket.nickname, \" : \").concat(data.message);\n        io.emit(\"chat\", response);\n      })[\"catch\"](function () {\n        console.log(\"iplocate catch\");\n        io.emit(\"chat\", response);\n      });\n    })[\"catch\"](function () {\n      console.log(\"public ip catch\");\n      io.emit(\"chat\", response);\n    });\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJMb2NhbFN0b3JhZ2UiLCJyZXF1aXJlIiwibG9jYWxTdG9yYWdlIiwiaXBsb2NhdGUiLCJhcHAiLCJzZXQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVCIsInVzZSIsImV4cHJlc3MiLCJwYXRoIiwiam9pbiIsIl9fZGlybmFtZSIsInNlcnZlciIsImh0dHAiLCJjcmVhdGVTZXJ2ZXIiLCJsaXN0ZW4iLCJnZXQiLCJjb25zb2xlIiwibG9nIiwiaW8iLCJ1c2VycyIsIm9uIiwic29ja2V0Iiwibmlja25hbWUiLCJ1cGRhdGVkVXNlcnMiLCJmaWx0ZXIiLCJ1c2VyIiwiZW1pdCIsInB1c2giLCJkYXRhIiwiZCIsIkRhdGUiLCJ0cyIsInRvTG9jYWxlU3RyaW5nIiwicmVzcG9uc2UiLCJtZXNzYWdlIiwicHVibGljSXAiLCJ2NCIsInRoZW4iLCJpcCIsInJlc3VsdHMiLCJyZXNwbyIsIkpTT04iLCJzdHJpbmdpZnkiLCJjaXR5Iiwic2V0SXRlbSJdLCJzb3VyY2VSb290IjoiRDpcXCQgQWRhbVxcJENvZGVcXE5vZGVKU1xccmVhbHRpbWUtY2hhdFxcIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcclxuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcclxuaW1wb3J0IGh0dHAgZnJvbSBcImh0dHBcIjtcclxuY29uc3QgTG9jYWxTdG9yYWdlID0gcmVxdWlyZShcIm5vZGUtbG9jYWxzdG9yYWdlXCIpLkxvY2FsU3RvcmFnZTtcclxuLy8gaW1wb3J0IExvY2FsU3RvcmFnZSBmcm9tIFwibm9kZS1sb2NhbHN0b3JhZ2VcIjtcclxubGV0IGxvY2FsU3RvcmFnZSA9IG5ldyBMb2NhbFN0b3JhZ2UoXCIuL3NjcmF0Y2hcIik7XHJcbmNvbnN0IGlwbG9jYXRlID0gcmVxdWlyZShcIm5vZGUtaXBsb2NhdGVcIik7XHJcbi8vIGltcG9ydCBpcGxvY2F0ZSBmcm9tIFwibm9kZS1pcGxvY2F0ZVwiO1xyXG5cclxuaW1wb3J0IHB1YmxpY0lwIGZyb20gXCJwdWJsaWMtaXBcIjtcclxuXHJcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcclxuXHJcbmFwcC5zZXQoXCJwb3J0XCIsIHByb2Nlc3MuZW52LlBPUlQgfHwgOTkwMCk7XHJcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgXCJwdWJsaWNcIikpKTtcclxuXHJcbi8vIFNldCB1cCBleHByZXNzXHJcbmNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCkubGlzdGVuKGFwcC5nZXQoXCJwb3J0XCIpLCAoKSA9PiB7XHJcbiAgY29uc29sZS5sb2coXCJFeHByZXNzIHNlcnZlciBsaXN0ZW5pbmcgb24gcG9ydCBcIiArIGFwcC5nZXQoXCJwb3J0XCIpKTtcclxufSk7XHJcblxyXG5jb25zdCBpbyA9IHJlcXVpcmUoXCJzb2NrZXQuaW9cIikoc2VydmVyKTtcclxuXHJcbmxldCB1c2VycyA9IFtdO1xyXG5cclxuLy8gY29ubmVjdGlvbiBldmVudFxyXG4vLyBzb2NrZXQgcmVwcmVzZW50IGVhY2ggY2xpZW50IGNvbm5lY3RlZCB0byBvdXIgc2VydmVyXHJcbmlvLm9uKFwiY29ubmVjdGlvblwiLCAoc29ja2V0KSA9PiB7XHJcbiAgc29ja2V0Lm9uKFwiY29ubmVjdFwiLCAoKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIk5ldyBjb25uZWN0aW9uIHNvY2tldC5pbyA6IFwiLCBzb2NrZXQuaW8pO1xyXG4gIH0pO1xyXG5cclxuICBzb2NrZXQub24oXCJkaXNjb25uZWN0XCIsICgpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwiZGlzY29uZWN0ID0+IG5pY2tuYW1lIDogXCIsIHNvY2tldC5uaWNrbmFtZSk7XHJcbiAgICBjb25zdCB1cGRhdGVkVXNlcnMgPSB1c2Vycy5maWx0ZXIoKHVzZXIpID0+IHVzZXIgIT0gc29ja2V0Lm5pY2tuYW1lKTtcclxuICAgIGNvbnNvbGUubG9nKFwidXBkYXRlZFVzZXJzIDogXCIsIHVwZGF0ZWRVc2Vycyk7XHJcbiAgICB1c2VycyA9IHVwZGF0ZWRVc2VycztcclxuICAgIGlvLmVtaXQoXCJ1c2VybGlzdFwiLCB1c2Vycyk7XHJcbiAgfSk7XHJcblxyXG4gIC8vICBuaWNrIGV2ZW50XHJcbiAgc29ja2V0Lm9uKFwibmlja1wiLCAobmlja25hbWUpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwibmljayA9PiBuaWNrbmFtZSA6IFwiLCBuaWNrbmFtZSk7XHJcbiAgICBzb2NrZXQubmlja25hbWUgPSBuaWNrbmFtZTtcclxuICAgIHVzZXJzLnB1c2gobmlja25hbWUpO1xyXG4gICAgY29uc29sZS5sb2coXCJzZXJ2ZXIgOiB1c2Vyc1wiLCB1c2Vycyk7XHJcbiAgICAvLyBlbWl0IHVzZXJsaXN0IGV2ZW50IHRvIGFsbCBjb25uZWN0ZWQgc29ja2V0c1xyXG4gICAgaW8uZW1pdChcInVzZXJsaXN0XCIsIHVzZXJzKTtcclxuICB9KTtcclxuXHJcbiAgLy8gIGNoYXQgZXZlbnRcclxuICBzb2NrZXQub24oXCJjaGF0XCIsIChkYXRhKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcImNoYXQgPT4gbmlja25hbWUgOiBcIiwgc29ja2V0Lm5pY2tuYW1lKTtcclxuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY29uc3QgdHMgPSBkLnRvTG9jYWxlU3RyaW5nKCk7XHJcbiAgICBjb25zb2xlLmxvZyhcInRzIDogXCIsIHRzKTtcclxuICAgIGNvbnNvbGUubG9nKFwicnMgOiBcIiwgcmVzcG9uc2UpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gYCR7dHN9IDogJHtzb2NrZXQubmlja25hbWV9IDogJHtkYXRhLm1lc3NhZ2V9YDtcclxuXHJcbiAgICBwdWJsaWNJcFxyXG4gICAgICAudjQoKVxyXG4gICAgICAudGhlbigoaXApID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImlwXCIsIGlwKTtcclxuICAgICAgICBpcGxvY2F0ZShpcClcclxuICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaXBsb2NhdGVcIiwgcmVzdWx0cyk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvID0gSlNPTi5zdHJpbmdpZnkocmVzdWx0cy5jaXR5KTtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ1c2VybG9jYWxcIiwgcmVzcG8pO1xyXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGAke3RzfSB8ICR7cmVzcG99IDogJHtzb2NrZXQubmlja25hbWV9IDogJHtkYXRhLm1lc3NhZ2V9YDtcclxuICAgICAgICAgICAgaW8uZW1pdChcImNoYXRcIiwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiaXBsb2NhdGUgY2F0Y2hcIik7XHJcbiAgICAgICAgICAgIGlvLmVtaXQoXCJjaGF0XCIsIHJlc3BvbnNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwicHVibGljIGlwIGNhdGNoXCIpO1xyXG4gICAgICAgIGlvLmVtaXQoXCJjaGF0XCIsIHJlc3BvbnNlKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBT0E7Ozs7QUFOQSxJQUFNQSxZQUFZLEdBQUdDLE9BQU8sQ0FBQyxtQkFBRCxDQUFQLENBQTZCRCxZQUFsRCxDLENBQ0E7OztBQUNBLElBQUlFLFlBQVksR0FBRyxJQUFJRixZQUFKLENBQWlCLFdBQWpCLENBQW5COztBQUNBLElBQU1HLFFBQVEsR0FBR0YsT0FBTyxDQUFDLGVBQUQsQ0FBeEIsQyxDQUNBOzs7QUFJQSxJQUFNRyxHQUFHLEdBQUcsMEJBQVo7QUFFQUEsR0FBRyxDQUFDQyxHQUFKLENBQVEsTUFBUixF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","map":{"version":3,"names":["LocalStorage","require","localStorage","iplocate","app","set","process","env","PORT","use","express","path","join","__dirname","server","http","createServer","listen","get","console","log","io","users","on","socket","nickname","updatedUsers","filter","user","emit","push","data","d","Date","ts","toLocaleString","response","message","publicIp","v4","then","ip","results","respo","JSON","stringify","city","setItem"],"sourceRoot":"D:\\$ Adam\\$Code\\NodeJS\\realtime-chat\\","sources":["app.js"],"sourcesContent":["import express from \"express\";\r\nimport path from \"path\";\r\nimport http from \"http\";\r\nconst LocalStorage = require(\"node-localstorage\").LocalStorage;\r\n// import LocalStorage from \"node-localstorage\";\r\nlet localStorage = new LocalStorage(\"./scratch\");\r\nconst iplocate = require(\"node-iplocate\");\r\n// import iplocate from \"node-iplocate\";\r\n\r\nimport publicIp from \"public-ip\";\r\n\r\nconst app = express();\r\n\r\napp.set(\"port\", process.env.PORT || 9900);\r\napp.use(express.static(path.join(__dirname, \"public\")));\r\n\r\n// Set up express\r\nconst server = http.createServer(app).listen(app.get(\"port\"), () => {\r\n  console.log(\"Express server listening on port \" + app.get(\"port\"));\r\n});\r\n\r\nconst io = require(\"socket.io\")(server);\r\n\r\nlet users = [];\r\n\r\n// connection event\r\n// socket represent each client connected to our server\r\nio.on(\"connection\", (socket) => {\r\n  socket.on(\"connect\", () => {\r\n    console.log(\"New connection socket.io : \", socket.io);\r\n  });\r\n\r\n  socket.on(\"disconnect\", () => {\r\n    console.log(\"disconect => nickname : \", socket.nickname);\r\n    const updatedUsers = users.filter((user) => user != socket.nickname);\r\n    console.log(\"updatedUsers : \", updatedUsers);\r\n    users = updatedUsers;\r\n    io.emit(\"userlist\", users);\r\n  });\r\n\r\n  //  nick event\r\n  socket.on(\"nick\", (nickname) => {\r\n    console.log(\"nick => nickname : \", nickname);\r\n    socket.nickname = nickname;\r\n    users.push(nickname);\r\n    console.log(\"server : users\", users);\r\n    // emit userlist event to all connected sockets\r\n    io.emit(\"userlist\", users);\r\n  });\r\n\r\n  //  chat event\r\n  socket.on(\"chat\", (data) => {\r\n    console.log(\"chat => nickname : \", socket.nickname);\r\n    const d = new Date();\r\n    const ts = d.toLocaleString();\r\n    console.log(\"ts : \", ts);\r\n    console.log(\"rs : \", response);\r\n    let response = `${ts} : ${socket.nickname} : ${data.message}`;\r\n\r\n    publicIp\r\n      .v4()\r\n      .then((ip) => {\r\n        console.log(\"ip\", ip);\r\n        iplocate(ip)\r\n          .then((results) => {\r\n            console.log(\"iplocate\", results);\r\n            const respo = JSON.stringify(results.city);\r\n            localStorage.setItem(\"userlocal\", respo);\r\n            const response = `${ts} | ${respo} : ${socket.nickname} : ${data.message}`;\r\n            io.emit(\"chat\", response);\r\n          })\r\n          .catch(() => {\r\n            console.log(\"iplocate catch\");\r\n            io.emit(\"chat\", response);\r\n          });\r\n      })\r\n      .catch(() => {\r\n        console.log(\"public ip catch\");\r\n        io.emit(\"chat\", response);\r\n      });\r\n  });\r\n});\r\n"],"mappings":"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"}},"mtime":1652166219956}}